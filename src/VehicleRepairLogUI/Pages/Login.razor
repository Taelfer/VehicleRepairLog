@page "/login"

@inject IAuthenticationService authenticationService
@inject NavigationManager navigationManager
@inject Blazored.LocalStorage.ILocalStorageService localStorageService

<h3>Login</h3>

<div class="col-xl-6 col-md-8 col-12">
    <input type="text" @bind="authenticationRequest.Username" class="form-control dark-theme-textbox" placeholder="username" />
</div>
<br/>
<div class="col-xl-6 col-md-8 col-12">
    <input type="password" @bind="authenticationRequest.Password" class="form-control dark-theme-textbox" placeholder="password" />
</div>
<div class="col-xl-6 col-md-8 col-12">
    <div class="col-xl-2 col-lg-2 col-md-6 col-sm-3 col-3">
        <button class="btn btn-danger" @onclick="AuthenticateJWT">Login</button>
    </div>
    <div class="col-xl-5 col-lg-5 col-md-6 col-sm-9 col-9">
        <a style="font-weight: bold;" href="/register">Create an account</a>
    </div>
</div>

@code {
    private AuthenticationRequest authenticationRequest = new();

    public async Task AuthenticateJWT()
    {
        var auth = await authenticationService.AuthenticateJWT(authenticationRequest);//authenticationRequest.Username, authenticationRequest.Password);

        if (auth is not null)
        {
            navigationManager.NavigateTo("/vehicles"); 
        }
        else
        {
            navigationManager.NavigateTo("/login");
        }
    }
}
